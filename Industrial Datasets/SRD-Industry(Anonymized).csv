测试问题,目标SQL,,,,,,,,,,,,,,
去年前3个月里，xxx产品的收入哪个月更高,"SELECT MONTH(`ftime`) AS `月份` FROM `表0` WHERE YEAR(`ftime`) = YEAR(NOW()) - 1 AND MONTH(`ftime`) IN (1, 2, 3) AND `prod_name` = 'xxx' GROUP BY `月份` ORDER BY SUM(`shouldincome_after`) DESC LIMIT 1",,,,,,,,,,,,,,
今年xxx产品毛利小于零的月份有哪些,SELECT MONTH(`ftime`) AS `月份` FROM `表0` WHERE `prod_name` = 'xxx' AND YEAR(`ftime`) = YEAR(NOW()) GROUP BY `月份` HAVING SUM(`gross_profit`) < 0,,,,,,,,,,,,,,
2023年的自主研究收入占比情况,SELECT SUM(`shouldincome_after`) / (SELECT SUM(`shouldincome_after`) FROM `宽表` WHERE YEAR(`ftime`) = 2023) * 100 AS `自主研究收入占比` FROM `表0` WHERE `prod_assess` = '自主研究' AND YEAR(`ftime`) = 2023,,,,,,,,,,,,,,
2023年每个月的自主研究收入情况,"SELECT MONTH(`ftime`) AS `月份`, SUM(`shouldincome_after`) AS `总收入` FROM `表0` WHERE YEAR(`ftime`) = 2023 AND `prod_assess` = '自主研究' GROUP BY `月份` ORDER BY `月份`",,,,,,,,,,,,,,
2023年xxx部门收入最高的产品是什么，收入是多少？,"SELECT `p_name` AS `产品名称`, SUM(`shouldincome_after`) AS `收入` FROM `表0` WHERE `sector_name` = 'xxx' AND YEAR(`ftime`) = YEAR(NOW()) - 1 GROUP BY `产品名称` ORDER BY `收入` DESC LIMIT 1",,,,,,,,,,,,,,
去年和今年消耗排名前5的客户的收入和毛利分别是多少,"SELECT `customer_name` AS `客户名称`, SUM(`gross_profit`) AS `总毛利`, SUM(`shouldincome_after`) AS `总收入` FROM `表0` WHERE YEAR(`ftime`) = YEAR(NOW()) GROUP BY `客户名称` ORDER BY SUM(`consume`) DESC LIMIT 5'",,,,,,,,,,,,,,
xxx客户的消耗去年环比变化了多少,SELECT (`this_year`.`income` - `last_year`.`income`) / `last_year`.`income` * 100 AS `收入_不含税环比` FROM (SELECT SUM(`consumeincome`) AS `income` FROM `表0` WHERE `customer_name` = 'xxx' AND YEAR(`ftime`) = YEAR(NOW()) - 1) AS `this_year` CROSS JOIN (SELECT SUM(`consumeincome`) AS `income` FROM `表0` WHERE `customer_name` = 'xxx' AND YEAR(`ftime`) = YEAR(NOW()) - 2) AS `last_year`,,,,,,,,,,,,,,
2023年XXX产品收入中YYY客户的占比是？,SELECT SUM(CASE WHEN `group_name` = ' YYY' THEN `shouldincome_after` ELSE 0 END) / SUM(`shouldincome_after`) * 100 AS `收入占比` FROM `表0` WHERE YEAR(`ftime`) = YEAR(NOW()) AND `prod_name` = 'XXX',,,,,,,,,,,,,,
查询XXX产品2023年收入月环比变化趋势,"SELECT `当前月收入`.`月份` AS `月份`, (`当前月收入`.`收入` - `上月收入`.`收入`) / `上月收入`.`收入` AS `月环比增长率` FROM (SELECT MONTH(`ftime`) AS `月份`, SUM(`shouldincome_after`) AS `收入` FROM `表0` WHERE YEAR(`ftime`) = 2023 AND `prod_name` = 'XXX' GROUP BY `月份`) AS `当前月收入` JOIN (SELECT MONTH(`ftime`) + 1 AS `月份`, SUM(`shouldincome_after`) AS `收入` FROM `表0` WHERE YEAR(`ftime`) = 2023 AND `prod_name` = 'XXX' GROUP BY `月份`) AS `上月收入` ON `当前月收入`.`月份` = `上月收入`.`月份` GROUP BY `月份` ORDER BY `月份`",,,,,,,,,,,,,,
2023年XXX部门A类和B类产品的收入占比,"SELECT SUM(CASE WHEN `product_type` = 'A' THEN `shouldincome_after` ELSE 0 END) / SUM(`shouldincome_after`) * 100 AS `A类收入占比`, SUM(CASE WHEN `product_type` = 'B' THEN `shouldincome_after` ELSE 0 END) / SUM(`shouldincome_after`) * 100 AS `B类收入占比` FROM `表0` WHERE YEAR(`ftime`) = 2023",,,,,,,,,,,,,,
